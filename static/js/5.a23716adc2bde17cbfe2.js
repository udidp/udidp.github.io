webpackJsonp([5],{Xm41:function(t,e){},zvMa:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Xxa5"),r=s.n(a),i=s("woOf"),n=s.n(i),o=s("exGp"),l=s.n(o),c=s("Dd8w"),p=s.n(c),u=s("0xDb"),b=s("A77I"),h=s("JX3P"),m=s("1plq"),d=s("FGy5"),v=s("GqfT"),x=s("2Qll"),f={name:"DomainRegistSub",components:{GobackNav:s("/hYL").a},computed:p()({getTotal:function(){return parseFloat(this.unitPrice*this.years).toFixed(2)},topExpireDate:function(){return this.topasset.expire?Object(u.h)(this.topasset.expire,"YYYY-MM-DD HH:mm:ss"):""},showErrorTips:function(){return this.topasset.owner&&!this.topasset.openApplied||this.exist},showTopDomain:function(){try{return Object(u.w)(this.topasset.name)}catch(t){return this.topasset.name}},DomainLabel:function(){return this.$t("l.Domain")},PriceLabel:function(){return this.$t("l.PriceBas")},PurchaseYearsLabel:function(){return this.$t("l.PurchaseYears")},RootDomainLabel:function(){return this.$t("p.ApplyTabRootName")},ExpireDateLabel:function(){return this.$t("p.DomainExpirationLable")},IsOwnerLabel:function(){return this.topasset.owner?this.$t("l.Owner"):this.$t("l.RootDomain")+" "+this.topText}},Vuex.mapGetters({ruleState:"dapp/ruleState"}),Vuex.mapState({maxRegYears:function(t){return t.dapp.maxRegYears}})),data:function(){return{topText:"",subText:"",years:1,unitPrice:4,exist:!1,topasset:{name:"",owner:""},errorMsg:"",ctrl:{loading:!1}}},methods:{goback:function(){this.$router.go(-1)},setUnitPrice:function(){var t=this.$store.getters["dapp/ruleState"],e=this.topasset,s=e.expire,a=parseInt((new Date).getTime()/1e3);if(e.owner&&e.openApplied&&e.isCustomed&&s-a>0){var r=e.customPrice;this.unitPrice=r?Object(u.C)(r):t.subBas}else this.unitPrice=t.subBas},checkSubHasTaken:function(t,e){var s=this;Object(v.d)(t,e,!1).then(function(e){s.exist=e,s.errorMsg=e?s.$t("p.DomainRegistSubHasTakenTips",{domaintext:t}):""}).catch(function(t){})},changeLower:function(t){t&&(this.subText=(t+"").trim().toLowerCase())},validForm:function(){var t="";if(""==this.subText)return this.$message(this.$basTip.error(this.$t("l.DomainInputTips"))),!1;var e=this.subText,s=this.$store.getters.web3State;try{if(""==this.topText)throw 1e4;if(e=this.subText+"."+this.topText,this.exist)throw 10011;if(Object(b.a)(e),this.topasset.owner&&!this.topasset.openApplied&&!Object(m.p)(this.topasset.owner,s.wallet))throw 10012;return!0}catch(s){switch(s){case 1e4:t=e+" "+this.$t("l.Illegal"),this.$message(this.$basTip.error(t));break;case 10001:t=this.$t("code.10001",{max:b.d}),this.$message(this.$basTip.error(t));break;case 10002:t=e+" "+this.$t("l.ErrorHasSpecialCharacter"),this.$message(this.$basTip.error(t));break;case 10003:t=e+" 域名超过二级",this.$message(this.$basTip.error(t));break;case 10004:t=e+" "+this.$t("l.ErrorHasUpperCase"),this.$message(this.$basTip.error(t));break;case 10011:t=e+" "+this.$t("g.DomainExist"),this.$message(this.$basTip.error(t));break;case 10012:t=""+e+this.$t("l.ErrorRootClosedRregist"),this.$message(this.$basTip.error(t));break;default:t=""+e+this.$t("l.Illegal"),this.$message(this.$basTip.error(t))}}},commitRegist:function(){var t=this;return l()(r.a.mark(function e(){var s,a,i,o,l,c,p,u,b;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$store.getters.metaMaskDisabled){e.next=3;break}return t.$metamask(),e.abrupt("return");case 3:if(!t.validForm()){e.next=40;break}return s=t.$store.getters["dapp/web3State"],a=s.chainId,i=s.wallet,o=t.subText,l=t.topText,c={isSubDomain:!0,domainText:o,topText:l,openApplied:!1,isCustomed:!1,customPriceWei:0,costWei:0,years:t.years,chainId:a,wallet:i},"",e.prev=11,t.ctrl.loading=!0,e.next=15,Object(x.b)(l,o,t.years,a,i);case 15:p=e.sent,u=n()({},c,{hash:p.hash,costWei:p.costwei}),t.$router.push({name:"domain.applyresult",params:{commitData:u}}),e.next=40;break;case 21:e.prev=21,e.t0=e.catch(11),t.ctrl.loading=!1,b="",e.t1=e.t0,e.next=e.t1===h.d?28:e.t1===h.c?28:e.t1===h.B?31:e.t1===h.h?31:e.t1===h.l?34:e.t1===h.k?34:e.t1===h.c?36:38;break;case 28:return b=t.$t("code."+e.t0,{text:o}),t.$message(t.$basTip.error(b)),e.abrupt("return");case 31:return b=t.$t("code."+e.t0,{text:l}),t.$message(t.$basTip.error(b)),e.abrupt("return");case 34:return t.$message(t.$basTip.error(t.$t("code."+e.t0))),e.abrupt("return");case 36:return e.abrupt("return");case 38:return e.abrupt("break",39);case 39:case 40:case"end":return e.stop()}},e,t,[[11,21]])}))()},gotoWhois:function(){this.topasset.owner&&this.topasset.name&&this.$router.push({path:"/domain/detail/"+this.topasset.name})}},mounted:function(){var t=this;return l()(r.a.mark(function e(){var s,a,i,o,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.b)();case 2:s=e.sent,a=t.$route.params,i=a.topText,t.topText=i,t.subText=a.subText||"",t.topasset=n()(t.topasset,{name:i}),o=s.chainId,i&&(Object(v.a)(i,o).then(function(e){e.state&&(t.topasset=n()({},e.assetinfo)),t.setUnitPrice()}).catch(function(e){t.setUnitPrice()}),t.subText&&void 0!==i&&(l=t.subText+"."+i,t.checkSubHasTaken(l,o)));case 11:case"end":return e.stop()}},e,t)}))()},watch:{subText:function(t,e){var s=this.topText,a=this.$store.getters["dapp/web3State"];if(""!==t&&""!==s&&a.chainId){var r=t+"."+s;this.checkSubHasTaken(r,a.chainId)}}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"row justify-content-center pt-3"},[s("div",{staticClass:"col-7 pb-2"},[s("goback-nav",{attrs:{clsName:"sub-goback-nav"}})],1),t._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.ctrl.loading,expression:"ctrl.loading"}],staticClass:"col-md-7 col-sm-10 bas-card"},[s("div",{staticClass:"bas-card__header"},[s("div",{staticClass:"bas-card__header-title"},[t._v("\n          "+t._s(t.$t("p.DomainRegistSubTitle"))+"\n        ")])]),t._v(" "),s("div",{staticClass:"bas-gray-split"}),t._v(" "),s("div",{staticClass:"bas-card__body bas-border-none"},[s("el-form",{staticClass:"col-10",attrs:{"label-width":"160px"}},[s("el-form-item",{attrs:{label:t.DomainLabel}},[s("el-input",{staticClass:"bas-regist--domain-input",attrs:{placeholder:"please enter domain..."},on:{input:t.changeLower},model:{value:t.subText,callback:function(e){t.subText=e},expression:"subText"}},[s("template",{slot:"append"},[t._v(t._s("."+t.showTopDomain))])],2),t._v(" "),Boolean(t.errorMsg)?s("div",{staticClass:"bas-text-warning"},[s("i",{staticClass:"fa fa-warning"}),t._v("\n              "+t._s(t.errorMsg)+"\n            ")]):t._e()],1),t._v(" "),s("el-form-item",{attrs:{label:t.PriceLabel}},[s("span",[t._v(" "+t._s(t.unitPrice)+" ")]),t._v(" "),s("span",[t._v(" BAS/year ")])]),t._v(" "),s("el-form-item",{attrs:{label:t.PurchaseYearsLabel}},[s("el-input-number",{attrs:{name:"years",controls:!0,"controls-position":"",min:1,max:t.ruleState.maxRegYears},model:{value:t.years,callback:function(e){t.years=e},expression:"years"}}),t._v(" "),s("span",[t._v("Year")])],1)],1),t._v(" "),s("div",{staticClass:"row justify-content-center align-items-center"},[s("el-form",{staticClass:"col-10 bas-topinfo-container",attrs:{size:"mini","label-position":"right"}},[s("el-form-item",[s("h6",{staticClass:"pt-2",attrs:{slot:"label"},slot:"label"},[t._v(t._s(t.$t("p.DomainRegistSubRootInfoTitle")))])]),t._v(" "),s("el-form-item",{attrs:{"label-width":"120px",label:t.RootDomainLabel}},[s("span",[t._v(t._s(t.showTopDomain))]),t._v(" "),t.topasset.owner?t._e():s("span",[t._v(t._s(t.$t("l.Unregist")))])]),t._v(" "),Boolean(t.topasset.owner)?s("el-form-item",{attrs:{"label-width":"120px",label:t.ExpireDateLabel}},[s("span",[t._v(t._s(t.topExpireDate))])]):t._e(),t._v(" "),""!==t.topasset.owner?s("el-form-item",{attrs:{"label-width":"120px"}},[s("label",{attrs:{slot:"label"},slot:"label"},[t._v("\n                "+t._s(t.$t("l.Owner"))+"\n              ")]),t._v(" "),s("span",[t._v("\n              "+t._s(t.topasset.owner)+"\n              ")])]):t._e(),t._v(" "),""!==t.topasset.owner?s("el-form-item",{attrs:{"label-width":"120px"}},[s("a",{staticClass:"bas-link topinfo-whois",attrs:{slot:"label"},on:{click:function(e){return e.preventDefault(),t.gotoWhois.apply(null,arguments)}},slot:"label"},[t._v("\n                Who is >>\n              ")])]):t._e()],1)],1),t._v(" "),s("div",{staticClass:"col-12 text-center pt-3"},[s("span",{staticClass:"bas-text-green"},[t._v(t._s(t.$t("l.Total"))+":")]),t._v(" "),s("h2",{staticClass:"d-inline bas-text-green"},[t._v(t._s(t.getTotal))]),t._v(" "),s("span",{staticClass:"bas-text-green"},[t._v("BAS")])])],1),t._v(" "),s("div",{staticClass:"bas-card__footer"},[s("button",{staticClass:"btn w-25 bas-btn-primary",attrs:{disabled:t.ctrl.loading},on:{click:t.commitRegist}},[t._v("\n            "+t._s(t.$t("l.RegistBtn"))+"\n          ")])])])])])},staticRenderFns:[]};var g=s("VU/8")(f,_,!1,function(t){s("Xm41")},null,null);e.default=g.exports}});
//# sourceMappingURL=5.a23716adc2bde17cbfe2.js.map