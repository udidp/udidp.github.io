webpackJsonp([43],{VGO3:function(t,e){},xCFx:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("pFYg");var r=a("woOf"),s=a.n(r),n=a("Xxa5"),i=a.n(n),o=a("exGp"),c=a.n(o),l=a("BO1k"),u=a.n(l),p=a("Dd8w"),d=a.n(p),b=a("0xDb"),m=a("A77I"),f=a("FGy5"),v=a("GqfT"),h=a("Xyu6"),g={name:"Favourite",components:{},computed:d()({domainType:function(){return""===this.domain?"":this.$t("g."+Object(m.i)(this.domain))}},Vuex.mapGetters({ruleState:"dapp/ruleState",minsubBas:function(t){return parseFloat(Object(b.D)(t.dapp.subGas))},maxYears:function(t){return t.dapp.maxRegYears}}),Vuex.mapState({dappState:function(t){return t.dapp}}),{getTotal:function(){var t=0,e=!0,a=!1,r=void 0;try{for(var s,n=u()(this.favourPriceTable);!(e=(s=n.next()).done);e=!0){var i=s.value;t+=i.price*i.duration}}catch(t){a=!0,r=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw r}}return t}}),data:function(){return{topText:"",subText:"",domain:"",years:1,openApplied:!0,isCustomed:!1,subUnitPrice:4,unitPrice:4,maxPriceBas:m.e,topasset:{name:"",owner:"",openApplied:!1,isCustomed:!1,customPrice:4*Math.pow(10,18)},subasset:{name:"",owner:""},ctrl:{loading:!1},favourTableData:[],favourPriceTable:[],takenFavourTable:[]}},methods:{formatExpireDate:function(t){return Object(b.h)(t,"YYYY-MM-DD HH:mm:ss")},gotoRegist:function(t,e,a){if(t.domain&&"Domain"===e.label)if(this.$store.getters.metaMaskDisabled)this.$metamask();else if(Object(m.m)(t.domain))this.$router.push({name:"domain.applydomain",params:{domainText:t.domain}});else{if(!Object(b.k)(t.domain)||!Object(b.j)(t.domain))return;this.$router.push({path:"/domain/applysub/"+Object(b.k)(t.domain)+"/"+Object(b.j)(t.domain)})}},handleSelectionChange:function(t){this.favourPriceTable=t},getFavourItems:function(){var t=this,e=JSON.parse(localStorage.favourList),a=this.$store.getters.web3State,r=function(e){Object(h.a)(e,a.chainId).then(function(a){if(a.state){var r={owner:"",expire:"",isFavor:!0};r.owner=a.assetinfo.owner,r.expire=t.formatExpireDate(a.assetinfo.expire),r.domain=e,t.takenFavourTable.push(r)}else{var s={price:"",duration:1,isFavor:!0};for(var n in s.domain=e,s.type=t.$t("g."+Object(m.i)(e)),"subdomain"===Object(m.i)(e)?t.loadSubasset(s):t.loadTopasset(s),t.favourTableData.push(s),t.favourTableData)t.favourTableData[n].total=t.favourTableData[n].price*t.favourTableData[n].duration}}).catch(function(t){})},s=!0,n=!1,i=void 0;try{for(var o,c=u()(e);!(s=(o=c.next()).done);s=!0){r(o.value)}}catch(t){n=!0,i=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw i}}},customedDurationChanged:function(t){for(var e in this.favourTableData)this.favourTableData[e].total=this.favourTableData[e].price*this.favourTableData[e].duration},deFavour:function(t){var e=this;return c()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$store.dispatch("favourite/deFavour",t.domain);case 2:e.favourTableData.remove(t);case 3:case"end":return a.stop()}},a,e)}))()},deTakenFavour:function(t){var e=this;return c()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$store.dispatch("favourite/deFavour",t.domain);case 2:e.takenFavourTable.remove(t);case 3:case"end":return a.stop()}},a,e)}))()},translateType:function(t){var e=Object(m.i)(t.domain);return this.$t("g."+e)},setUnitPrice:function(t){var e=this.$store.getters["dapp/ruleState"];if(void 0===t.domain||""===t.domain||""===t.domain.trim())return t.price=e.subBas,void(t.total=t.price*t.duration);var a=Object(m.i)(t.domain),r=this.topasset;switch(a){case"subdomain":t.price=e.subBas,r.owner&&r.openApplied&&r.isCustomed,t.price=Object(b.D)(r.customPrice),t.total=t.price*t.duration;break;case"raretop":t.price=e.rareBas,t.total=t.price*t.duration;break;case"commontop":t.price=e.rootBas,t.total=t.price*t.duration}},setSubUnitPrice:function(t){var e=this.$store.getters["dapp/ruleState"],a=this.subasset,r=a.expire,s=parseInt((new Date).getTime()/1e3);if(a.owner&&a.openApplied&&a.isCustomed&&r-s>0){var n=a.customPrice;t.price=n?Object(b.D)(n):e.subBas,t.total=t.price*t.duration}else t.price=e.subBas,t.total=t.price*t.duration},loadTopasset:function(t){var e=this;return c()(i.a.mark(function a(){var r,n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e,r=e.$store.getters["dapp/web3State"],(n=r.chainId)&&Object(v.a)(t.domain,n).then(function(a){e.setUnitPrice(t),a.state&&(e.topasset=s()({},a.assetinfo),e.setUnitPrice(t))}).catch(function(t){});case 4:case"end":return a.stop()}},a,e)}))()},loadSubasset:function(t){var e=this;return c()(i.a.mark(function a(){var r,n,o,c;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.b)();case 2:r=a.sent,n=t.domain.split("."),o=n[1],e.topText=o,e.subText=n[0]||"",e.subasset=s()(e.subasset,{name:o}),c=r.chainId,o&&Object(v.a)(o,c).then(function(a){a.state&&(e.subasset=s()({},a.assetinfo)),e.setSubUnitPrice(t)}).catch(function(a){e.setSubUnitPrice(t)});case 10:case"end":return a.stop()}},a,e)}))()},resetTopAsset:function(){var t=this.$store.state.dapp.subGas;this.topasset=s()({},{name:"",owner:"",openApplied:!1,isCustomed:!1,customPrice:t})},validForm:function(){var t=this.domain,e="";try{if(Object(m.a)(t),this.topasset.owner&&!this.topasset.openApplied)throw 10012;return!0}catch(a){switch(a){case 1e4:e=t+" "+this.$t("l.Illegal");break;case 10001:e=this.$t("code.10001",{max:m.d});break;case 10002:e=t+" "+this.$t("l.ErrorHasSpecialCharacter");break;case 10003:e=t+" 域名超过二级";break;case 10004:e=t+" "+this.$t("l.ErrorHasUpperCase");break;case 10012:e=t+" "+this.$t("l.ErrorHasSpecialCharacter");break;default:e=t+" "+this.$t("l.Illegal")}return this.$message(this.$basTip.error(e)),!1}},batchRegist:function(){var t=!0,e=!1,a=void 0;try{for(var r,s=u()(this.favourPriceTable);!(t=(r=s.next()).done);t=!0){r.value.type}}catch(t){e=!0,a=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw a}}},commitSubRegist:function(){var t=this;return c()(i.a.mark(function e(){var a,r,n,o,c,l,u,p,d;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$store.getters.metaMaskDisabled){e.next=3;break}return t.$metamask(),e.abrupt("return");case 3:if(!t.validForm()){e.next=40;break}return a=t.$store.getters["dapp/web3State"],r=a.chainId,n=a.wallet,o=t.subText,c=t.topText,l={isSubDomain:!0,domainText:o,topText:c,openApplied:!1,isCustomed:!1,customPriceWei:0,costWei:0,years:t.years,chainId:r,wallet:n},"",e.prev=11,t.ctrl.loading=!0,e.next=15,preCheck4Sub(c,o,t.years,r,n);case 15:u=e.sent,p=s()({},l,{hash:u.hash,costWei:u.costwei}),t.$router.push({name:"domain.applyresult",params:{commitData:p}}),e.next=40;break;case 21:e.prev=21,e.t0=e.catch(11),t.ctrl.loading=!1,d="",e.t1=e.t0,e.next=e.t1===DOMAIN_HAS_TAKEN?28:e.t1===DOMAIN_FORMAT_ILLEGAL?28:e.t1===ROOT_REGIST_CLOSE?31:e.t1===DOMAIN_TOP_EXPIRED?31:e.t1===LACK_OF_TOKEN?34:e.t1===LACK_OF_ETH?34:e.t1===DOMAIN_FORMAT_ILLEGAL?36:38;break;case 28:return d=t.$t("code."+e.t0,{text:o}),t.$message(t.$basTip.error(d)),e.abrupt("return");case 31:return d=t.$t("code."+e.t0,{text:c}),t.$message(t.$basTip.error(d)),e.abrupt("return");case 34:return t.$message(t.$basTip.error(t.$t("code."+e.t0))),e.abrupt("return");case 36:return e.abrupt("return");case 38:return e.abrupt("break",39);case 39:case 40:case"end":return e.stop()}},e,t,[[11,21]])}))()},commitRegist:function(t){var e=this;return c()(i.a.mark(function t(){var a,r,s,n,o,c,l,u,p;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=regDomain.domain,e.validForm()){t.next=3;break}return t.abrupt("return");case 3:if(!e.$store.getters.metaMaskDisabled){t.next=6;break}return e.$metamask(),t.abrupt("return");case 6:if(r=Object(m.l)(a),s=e.$store.getters["dapp/web3State"],n=s.chainId,o=e.subUnitPrice,!(parseFloat(o)<=0)){t.next=14;break}return c=e.$t("p.SaleOnPriceUnitBasValidError",{begin:0,end:Object(b.v)(m.e)}),e.$message(e.$basTip.error(c)),t.abrupt("return");case 14:return t.prev=14,t.next=17,Object(v.d)(a,n,!r);case 17:if(!t.sent){t.next=21;break}return e.$message(e.$basTip.error(e.$t("code.200002",{domaintext:a}))),t.abrupt("return");case 21:t.next=27;break;case 23:return t.prev=23,t.t0=t.catch(14),t.abrupt("return");case 27:if(!r){t.next=35;break}return l=Object(m.g)(a.trim().toLowerCase()),u=l.subtext,p=l.toptext,t.next=33,e.commitSubRegisting(u,p);case 33:t.next=37;break;case 35:return t.next=37,e.commitTopRegisting(a);case 37:case"end":return t.stop()}},t,e,[[14,23]])}))()},commitSubRegisting:function(t,e){var a=this;return c()(i.a.mark(function r(){var n,o,c,l,u,p,d;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=a.$store.getters["dapp/web3State"],o=n.chainId,c=n.wallet,l={isSubDomain:!0,domainText:t,topText:e,openApplied:!1,isCustomed:!1,customPriceWei:Object(b.e)(a.subUnitPrice+""),costWei:0,years:a.years,chainId:o,wallet:c},r.prev=4,a.ctrl.loading=!0,r.next=8,preCheck4Sub(e,t,a.years,o,c);case 8:u=r.sent,a.ctrl.loading=!1,p=s()({},l,{hash:u.hash,costWei:u.costwei}),a.$router.push({name:"domain.applyresult",params:{commitData:p}}),r.next=34;break;case 15:r.prev=15,r.t0=r.catch(4),a.ctrl.loading=!1,d="",r.t1=r.t0,r.next=r.t1===DOMAIN_HAS_TAKEN?22:r.t1===DOMAIN_FORMAT_ILLEGAL?22:r.t1===ROOT_REGIST_CLOSE?25:r.t1===DOMAIN_TOP_EXPIRED?25:r.t1===LACK_OF_TOKEN?28:r.t1===LACK_OF_ETH?28:r.t1===DOMAIN_FORMAT_ILLEGAL?30:32;break;case 22:return d=a.$t("code."+r.t0,{text:t}),a.$message(a.$basTip.error(d)),r.abrupt("return");case 25:return d=a.$t("code."+r.t0,{text:e}),a.$message(a.$basTip.error(d)),r.abrupt("return");case 28:return a.$message(a.$basTip.error(a.$t("code."+r.t0))),r.abrupt("return");case 30:return r.abrupt("return");case 32:return r.abrupt("break",33);case 33:case 34:case"end":return r.stop()}},r,a,[[4,15]])}))()},commitTopRegisting:function(t){var e=this;return c()(i.a.mark(function a(){var r,n,o,c,l,u,p,d;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return"",r=e.$store.getters["dapp/web3State"],n=r.chainId,o=r.wallet,Object(b.e)(e.getTotal),c=Object(b.e)(e.subUnitPrice),l={isSubDomain:!1,domainText:t,openApplied:e.openApplied,isCustomed:e.isCustomed,customPriceWei:c,years:e.years,chainId:n,wallet:o},u={domaintext:t,isCustomed:e.isCustomed,customWei:c,years:e.years,chainId:n,wallet:o},a.prev=9,e.ctrl.loading=!0,a.next=13,preCheck4Root(u);case 13:p=a.sent,e.ctrl.loading=!1,e.$router.push({name:"domain.applyresult",params:{commitData:s()({},l,{costWei:p.costwei,hash:p.hash})}}),a.next=37;break;case 18:a.prev=18,a.t0=a.catch(9),e.ctrl.loading=!1,d="",a.t1=a.t0,a.next=a.t1===DOMAIN_HAS_TAKEN?25:a.t1===DOMAIN_FORMAT_ILLEGAL?25:a.t1===ROOT_REGIST_CLOSE?28:a.t1===DOMAIN_TOP_EXPIRED?28:a.t1===LACK_OF_TOKEN?31:a.t1===LACK_OF_ETH?31:a.t1===DOMAIN_FORMAT_ILLEGAL?33:35;break;case 25:case 28:return d=e.$t("code."+a.t0,{text:t}),e.$message(e.$basTip.error(d)),a.abrupt("return");case 31:return e.$message(e.$basTip.error(e.$t("code."+a.t0))),a.abrupt("return");case 33:return a.abrupt("return");case 35:return a.abrupt("break",36);case 36:case 37:case"end":return a.stop()}},a,e,[[9,18]])}))()}},created:function(){this.getFavourItems()},mounted:function(){this.domain=this.$route.params.domainText;var t=Object(b.k)(this.domain);t&&this.loadTopasset(t)},watch:{domain:function(t,e){if(t&&t!==e&&Object(m.l)(t)){var a=Object(b.k)(t);a?this.loadTopasset(a):this.resetTopAsset()}}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticClass:"bas-white-bg",staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[a("el-col",{staticClass:"bas-fav-info",attrs:{span:24}},[a("div",{staticClass:"bas-card__header"},[a("div",{staticClass:"bas-card__header-title"},[t._v("\n          "+t._s(t.$t("l.walletFav"))+"\n        ")])])])],1),t._v(" "),a("el-row",{staticClass:"bas-white-bg",attrs:{gutter:20}},[a("el-col",{staticClass:"bas-fav-info",attrs:{span:24}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.ctrl.loading,expression:"ctrl.loading"}],staticClass:"bas-card__body bas-border-none"},[a("div",{staticClass:"not-taken"},[a("span",{staticClass:"not-taken"},[t._v(t._s(t.$t("l.notTaken")))]),t._v(" "),a("el-table",{ref:"multipleTableRef",staticStyle:{width:"100%"},attrs:{type:"index",data:t.favourTableData},on:{"selection-change":t.handleSelectionChange,"cell-click":t.gotoRegist}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left","class-name":["column-domain"],label:"Domain","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.domain))]}}])}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",property:"type",formatter:t.translateType,label:"Type",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",property:"price",label:"Price",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{"header-align":"center",align:"center",property:"duration",label:"Duration","show-overflow-tooltip":"","min-width":"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("Year:")]),t._v(" "),a("el-input-number",{attrs:{precision:2,step:1,"controls-position":"",min:1,max:t.ruleState.maxRegYears},on:{change:t.customedDurationChanged},model:{value:e.row.duration,callback:function(a){t.$set(e.row,"duration",a)},expression:"scope.row.duration"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",label:"Total"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.total))]}}])}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",label:"Favourite","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{cursor:"pointer"},attrs:{src:e.row.isFavor?"/static/icons/favour.svg":"/static/icons/unfavour.svg",alt:""},on:{click:function(a){return t.deFavour(e.row)}}})]}}])})],1)],1)])])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{staticClass:"text-center regist-footer",attrs:{span:24}},[a("div",{staticClass:"total"},[a("span",{staticStyle:{color:"#fff"}},[t._v(t._s(t.$t("l.Total"))+":")]),t._v(" "),a("h2",{staticClass:"d-inline bas-text-green"},[t._v(t._s(t.getTotal))]),t._v(" "),a("span",{staticClass:"bas-text-green"},[t._v("UDID")])]),t._v(" "),a("div",{staticClass:"bas-card__footer"},[a("button",{staticClass:"btn bas-btn-primary",on:{click:t.batchRegist}},[t._v("\n          "+t._s(t.$t("l.RegistBtn"))+"\n        ")])])])],1),t._v(" "),a("el-row",{staticClass:"bas-white-bg",staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{staticClass:"bas-fav-info",attrs:{span:24}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.ctrl.loading,expression:"ctrl.loading"}],staticClass:"bas-card__body bas-border-none"},[a("div",{staticClass:"not-taken"},[a("span",{staticClass:"not-taken"},[t._v(t._s(t.$t("l.taken")))]),t._v(" "),a("el-table",{ref:"multipleTableRef",staticStyle:{width:"100%"},attrs:{data:t.takenFavourTable},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{"header-align":"left",align:"left","class-name":["column-domain"],label:"Domain","min-width":"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.domain))]}}])}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",property:"type",formatter:t.translateType,label:"Type",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",property:"owner",label:"Owner","min-width":"300"}}),t._v(" "),a("el-table-column",{attrs:{property:"expire",label:"Expire","show-overflow-tooltip":"","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("Exp:")]),t._v("\n                "+t._s(e.row.expire)+"\n              ")]}}])}),t._v(" "),a("el-table-column",{attrs:{"header-align":"left",align:"left",label:"Favourite","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{cursor:"pointer"},attrs:{src:e.row.isFavor?"/static/icons/favour.svg":"/static/icons/unfavour.svg",alt:""},on:{click:function(a){return t.deTakenFavour(e.row)}}})]}}])})],1)],1)])])],1)],1)},staticRenderFns:[]};var w=a("VU/8")(g,_,!1,function(t){a("VGO3")},null,null);e.default=w.exports}});
//# sourceMappingURL=43.ded8b690f83a1436f62d.js.map