webpackJsonp([4],{qNNh:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s("woOf"),i=s.n(e),n=s("Dd8w"),r=s.n(n),o=s("82Js"),c=s("uIu7"),h=s("JX3P"),l={name:"MailRegisting",components:{LoadingDot:s("g1m8").a},computed:r()({showState:function(){var t=this.registState;if(!this.commitData.domainhash)return"";switch(t){case c.a:return this.$t("p.DomainRegistApprove");case c.b:return this.$t("p.DomainRegistConfirm");case c.d:return this.$t("p.DomainRegistSuccess");case c.c:default:return this.$t("p.DomainRegistFail")}},titleText:function(){return this.commitData.mailname+"@"+this.commitData.domaintext},inprogress:function(){var t=this.registState;return t===c.a||t===c.b},confBtnDisabled:function(){var t=this.registState;return t===c.a||t===c.b||t===c.c}},Vuex.mapState({mailGas:function(t){return t.dapp.mailRegGas}})),data:function(){return{commitData:{},txHashes:[],ctrl:{loading:!1},registState:c.a}},methods:{addTxHashItem:function(t,a){this.txHashes.push({hash:t,state:a})},comboFulltext:function(t,a,s){if("string"==typeof s&&s)return""},updateTxHashState:function(t,a){var s=this.txHashes.findIndex(function(a){return a.hash===t});s>=0&&this.txHashes.splice(s,1,{hash:t,state:a})},updateTxHashFail:function(){this.txHashes=this.txHashes.map(function(t){return t.state===c.f&&(t.state=c.e),t})},commitApprove:function(){var t=this,a=this.$store.getters.web3State,s=a.chainId,e=a.wallet,i=this.commitData,n=i.domainhash,r=i.mailhash,l=i.costwei;if(l&&n&&r){var d="";try{var m=this;Object(o.f)(l,s,e).on("transactionHash",function(t){m.registState=c.a,m.addTxHashItem(t,c.f)}).on("receipt",function(t){t.status?(m.registState=c.b,m.updateTxHashState(t.transactionHash,c.g)):(m.registState=c.c,m.updateTxHashState(t.transactionHash,c.e))}).on("err",function(t,a){m.registState=c.c,m.updateTxHashFail()}).catch(function(a){if(m.registState=c.c,m.updateTxHashFail(),a.code===h.G)d=m.$t("code."+a.code),m.$message(m.$basTip.error(d));else if(a.code===h.C)return d=t.$t("code.-32603"),void t.$message(t.$basTip.error(d))})}catch(t){that.registState=c.a}}},commitSendConfirm:function(){var t=this,a=this.$store.getters.web3State,s=a.chainId,e=a.wallet,i=this.commitData,n=i.domainhash,r=i.years,l=i.domaintext,d=i.mailalias,m=i.mailhash;if(r&&l&&n&&m){void 0===d&&(d="");var u="",f=this;try{Object(o.g)(r,l,m,d,s,e,n).on("transactionHash",function(t){f.addTxHashItem(t,c.f)}).on("receipt",function(t){t.status?(f.registState=c.d,f.updateTxHashState(t.transactionHash,c.g)):(f.registState=c.c,f.updateTxHashState(t.transactionHash,c.e))}).on("err",function(t,a){f.registState=c.c,f.updateTxHashFail()}).catch(function(a){return f.registState=c.c,a.code===h.G?(u=f.$t("code."+h.G),void f.$message(f.$basTip.error(u))):a.code===h.C?(u=t.$t("code.-32603"),void t.$message(t.$basTip.error(u))):void 0})}catch(t){}}},gotoMailConfiguration:function(){var t=this.$route.params.domaintext,a=this.commitData.mailhash;this.$router.push({path:"/mail/detail_conf",query:{domaintext:t,hash:a}})},gotoMyMailList:function(){this.$store.getters.metaMaskDisabled?this.$metamask():this.$router.push({name:"wallet.maillist"})},continueRegist:function(){this.$store.getters.metaMaskDisabled?this.$metamask():this.$router.push({path:"/mail/regist"})}},mounted:function(){var t=this.$route.params.commitData||{},a=this.$route.params.domaintext||t.domaintext,s=this.$route.params.years,e=this.$route.params.mailname;this.commitData=i()({},t,{domaintext:a,years:s,mailname:e});new Web3.utils.BN(s+"").mul(new Web3.utils.BN(this.mailGas)).toString();this.commitApprove()},watch:{registState:function(t,a){a===c.a&&t===c.b&&this.commitSendConfirm()}}},d={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"background-fill-wrapper bas-gray-bg"},[s("div",{staticClass:"container"},[s("div",{staticClass:"row justify-content-center align-items-center pt-5"},[s("el-card",{staticClass:"col-md-8 col-sm-10 box-card"},[s("div",{staticClass:"clearfix regist-header",attrs:{slot:"header"},slot:"header"},[s("div",{staticClass:"regist-header--title"},[s("h3",[t._v(t._s(t.titleText))])]),t._v(" "),s("div",{staticClass:"regist-header--state"},[s("span",[t._v(t._s(t.showState))])])]),t._v(" "),s("div",{staticClass:"tx-hashes-container"},[s("div",{staticClass:"tx-hash-header"},[s("h5",[t._v("Transaction Hash")])])]),t._v(" "),t._l(t.txHashes,function(a,e){return s("div",{key:e,staticClass:"text item bas-inline-between"},[s("div",{},[t._v(t._s(a.hash))]),t._v(" "),"loading"===a.state?s("div",[s("loading-dot")],1):"success"===a.state?s("div",[s("i",{staticClass:"fa fa-check bas-text-green"})]):"fail"===a.state?s("div",[s("i",{staticClass:"fa fa-close text-danger"})]):t._e()])})],2),t._v(" "),s("el-card",{staticClass:"col-md-8 col-sm-10 box-card"},[s("div",{staticClass:"regist-btns-wrapper"},[s("el-button",{staticClass:"w-25 mx-2",attrs:{disabled:t.confBtnDisabled},on:{click:t.gotoMailConfiguration}},[t.confBtnDisabled?s("i",{staticClass:"fa fa-ban"}):t._e(),t._v("\n            "+t._s(t.$t("l.UpdateConfiguration"))+"\n          ")]),t._v(" "),s("el-button",{staticClass:"w-25 mx-2",attrs:{disabled:t.inprogress},on:{click:t.gotoMyMailList}},[t.inprogress?s("i",{staticClass:"fa fa-ban"}):t._e(),t._v("\n            "+t._s(t.$t("l.GtotoMyBMails"))+"\n          ")]),t._v(" "),s("el-button",{staticClass:"w-25 mx-2 bas-btn-primary",attrs:{disabled:t.inprogress},on:{click:t.continueRegist}},[t.inprogress?s("i",{staticClass:"fa fa-ban"}):t._e(),t._v("\n            "+t._s(t.$t("l.ApplyAgain"))+"\n          ")])],1)])],1)])])},staticRenderFns:[]};var m=s("VU/8")(l,d,!1,function(t){s("wdtm")},null,null);a.default=m.exports},wdtm:function(t,a){}});
//# sourceMappingURL=4.123a5f56b86b807f84ee.js.map