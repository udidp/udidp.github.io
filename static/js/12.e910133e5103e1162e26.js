webpackJsonp([12],{Bu4q:function(e,t){},TCjW:function(e,t){},f8iq:function(e,t){},s7Oh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),n=a.n(i),l=a("exGp"),s=a.n(l),r=a("woOf"),o=a.n(r),c=a("Dd8w"),d=a.n(c),p=a("g1m8"),g=a("J3VU"),h=a("0xDb"),u=(a("1rPB"),a("941m")),v={name:"WalletSellingTable",computed:{},data:function(){return{pagenumber:1,pagesize:10,total:0,domains:[],ruleState:{decimals:18}}},methods:{handleRevokeSale:function(e,t){},cancelRevoke:function(){this.revokeDialog.visible=!1,this.revokeDialog.domainText="",this.revokeDialog.hash=""}},mounted:function(){this.domains=o()(this.items),this.total=this.initTotal},props:{items:{default:[],type:Array},initTotal:Number}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("el-table",{staticStyle:{width:"100%"},attrs:{"show-header":!1,data:e.domains}},[a("el-table-column",{attrs:{prop:"domaintext",label:"域名",width:"260"}}),e._v(" "),a("el-table-column",{attrs:{prop:"expireDate",label:"到期日期",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"priceVol",sortable:"",label:"价格"}}),e._v(" "),a("el-table-column",{attrs:{"header-align":"center",align:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleRevokeSale(t.$index,t.row)}}},[e._v("\n          撤回\n        ")])]}}])})],1)],1)},staticRenderFns:[]};var b=a("VU/8")(v,m,!1,function(e){a("TCjW")},null,null).exports,f=a("QioY"),k=a("A77I"),w=(a("69sS"),a("4s8G"),a("U/4D")),x={name:"UserInTransaction",components:{LoadingDot:p.a,SellingTable:b,ElTabLoading:g.a},computed:d()({},Vuex.mapState({sellItems:function(e){return e.ewallet.orders},syncState:function(e){return e.ewallet.ordersLoading},chainId:function(e){return e.dapp.chainId},wallet:function(e){return e.dapp.wallet}}),{OnSaleTabName:function(){return this.$t("l.Selling")},revokeVisible:function(){return this.revokeDialog.visible},revokeTips:function(){return"zh-CN"===this.$store.state.lang?"您确定要撤回域名["+this.revokeDialog.domaintext+"]":"Are you sure you want to remove ["+this.revokeDialog.domaintext+"]"}}),data:function(){return{activeTab:"selling",sellTotal:0,allItems:[],pager:{pagenumber:1,pagesize:200,total:0,loading:!1},revokeDialog:{loading:!1,visible:!1,domaintext:"",hash:""},cpd:{loading:!1,visible:!1,hash:"",domaintext:"",pricevol:"",validState:!0,error:""},validRules:{price:[]},ctrl:{minprice:0,maxprice:1e8},ruleState:{decimals:18}}},methods:{timeFormat:function(e,t,a){return Object(h.h)(a)},priceChangeValid:function(e,t){var a="zh-CN"===this.$store.state.lang;""===e||parseFloat(e)<=0||parseFloat(e-this.ctrl.maxprice)>0?(this.cpd.validState=!1,this.cpd.error=a?"请设置[0~100,000,000]区间价格":"Pricing must be between 0 and 100,000,000"):(this.cpd.validState=!0,this.cpd.error="")},handleTabClick:function(e,t){},getCurrentPage:function(e){},gotoDetail:function(e,t,a){e.domaintext&&"domain"===t.index&&(this.$store.getters.metaMaskDisabled?this.$metamask():this.$router.push({path:"/domain/detail/"+e.domaintext}))},dialogBeforClose:function(){},handleRevokeSale:function(e,t){if(this.$store.getters.metaMaskDisabled)this.$metamask();else{var a=this.$store.getters.web3State,i=a.wallet;if(Object(h.s)(t.owner,a.wallet))this.revokeDialog=o()(this.revokeDialog,{loading:!1,visible:!0,domaintext:t.domaintext,hash:t.hash});else{var n="当前操作域名"+t.domaintext+" 不在登录账户 ["+i+"]下,请刷新页面确认.";this.$message(this.$basTip.error(n))}}},cancelRevoke:function(){this.revokeDialog=o()(this.revokeDialog,{loading:!1,visible:!1,domaintext:"",hash:""})},confirmRevoke:function(){var e=this;return s()(n.a.mark(function t(){var a,i,l,s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$store.getters.metaMaskDisabled){t.next=3;break}return e.$metamask(),t.abrupt("return");case 3:return a=e.$store.getters.web3State,i=a.chainId,l=a.wallet,s=e.revokeDialog.hash,t.prev=8,e.revokeDialog.loading=!0,t.next=12,Object(f.e)(s,i,l);case 12:t.sent,e.$store.dispatch("ewallet/loadEWalletOrders",a),e.revokeDialog=o()(e.revokeDialog,{loading:!1,visible:!1,domaintext:"",hash:""}),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(8),e.revokeDialog.loading=!1;case 21:case"end":return t.stop()}},t,e,[[8,17]])}))()},handleEditPrice:function(e,t){if(this.$store.getters.metaMaskDisabled)this.$metamask();else{var a=this.$store.getters.web3State.wallet;if(Object(h.s)(t.owner,a))this.cpd=o()({loading:!1,visible:!0,domaintext:t.domaintext,hash:t.hash,pricevol:t.price});else{var i="当前操作域名"+t.domaintext+" 不在登录账户 ["+a+"]下,请刷新页面确认.";this.$message(this.$basTip.error(i))}}},cancelChangePrice:function(){this.cpd=o()({loading:!1,visible:!1,domaintext:"",hash:"",pricevol:0})},submitChangeDomainPrice:function(){var e=this;return s()(n.a.mark(function t(){var a,i,l,s,r,c;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a="",!e.$store.getters.metaMaskDisabled){t.next=4;break}return e.$metamask(),t.abrupt("return");case 4:if(e.cpd.validState){t.next=7;break}return e.$message(e.$basTip.error("你输入的价格必须大于"+e.ctrl.minprice+",并且小于"+e.ctrl.maxprice)),t.abrupt("return");case 7:if(Object(k.n)(e.cpd.pricevol)){t.next=11;break}return a=e.$t("p.SaleOnPriceUnitBasValidError",{begin:"0",end:Object(h.u)(k.e)}),e.$message(e.$basTip.error(a)),t.abrupt("return");case 11:return i=e.$store.getters.web3State,l=i.chainId,s=i.wallet,r=e.cpd.hash,t.prev=16,t.next=19,Object(f.j)(r,e.cpd.pricevol,l,s);case 19:return c=t.sent,e.cpd.loading=!0,t.prev=21,t.next=24,Object(f.c)(c.domainhash,c.salewei,c.chainId,c.wallet);case 24:t.sent,e.$store.dispatch("ewallet/updateEWalletOrders",{hash:c.domainhash,price:c.salewei}),e.cpd=o()({loading:!1,visible:!1,hash:"",domaintext:"",pricevol:"",validState:!0,error:""}),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(21),e.cpd.loading=!1;case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(16);case 38:case"end":return t.stop()}},t,e,[[16,35],[21,29]])}))()},reloadSellItems:function(){var e=this.$store.getters.web3State;e.chainId&&e.wallet&&this.$store.dispatch("ewallet/loadEWalletOrders",e)},pagerChange:function(e){this.pageTrigger(e)},prevChange:function(e){this.pageTrigger(e)},nextChange:function(e){this.pageTrigger(e)},pageTrigger:function(e){var t={pagenumber:e,pagesize:this.pager.pagesize};this.loadSellItems(t)},loadSellItems:function(e){var t=this,a=e.pagenumber,i=void 0===a?1:a,n=e.pagesize,l=void 0===n?10:n,s=this.$store.getters.web3State.wallet;if(s){var r=this.ruleState.decimals,c=new u.a;this.pager.loading=!0,c.getSellingDomains({pagenumber:i,pagesize:l,wallet:s}).then(function(e){if(e.state){t.sellTotal=e.totalpage,t.pager.pagenumber=e.pagenumber||i,t.pager.pagesize=l,t.pager.total=e.totalpage;var a=e.domains.map(function(e){return e.expireDate=e.expiretime?Object(h.h)(e.expiretime,h.d):"",e.shortAddress=Object(h.g)(e.owner),e.priceVol=Object(h.E)(e.price,r),e.domaintext=Object(h.w)(e.domain),e});t.sellItems=o()(a)}else t.pager.total=0;t.pager.loading=!1}).catch(function(e){t.pager.loading=!1})}else this.$metamask({name:"wallet.transaction"})}},mounted:function(){var e=this;return s()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(a=e.$store.getters.web3State).chainId&&a.wallet&&e.$store.dispatch("ewallet/loadEWalletOrders",a);case 3:case"end":return t.stop()}},t,e)}))()},watch:{syncState:function(e,t){},wallet:function(e){Object(w.a)(this.chainId)&&e&&this.$store.dispatch("ewallet/loadEWalletOrders",{chainId:this.chainId,wallet:e})},chainId:function(e){Object(w.a)(e)&&this.wallet&&this.$store.dispatch("ewallet/loadEWalletOrders",{chainId:e,wallet:this.wallet})}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"bas-white-bg",attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pager.loading,expression:"pager.loading"}],staticStyle:{width:"100%"},attrs:{type:"index","show-header":!0,data:e.sellItems},on:{"cell-click":e.gotoDetail}},[a("el-table-column",{attrs:{"class-name":"bas-link",prop:"domaintext",index:"domain",label:e.$t("l.Domain")}}),e._v(" "),a("el-table-column",{attrs:{width:"240",prop:"price",sortable:!1,label:e.$t("l.PriceBas")+"(BAS)"}}),e._v(" "),a("el-table-column",{attrs:{"header-align":"center",width:"220",align:"center",label:e.$t("l.Operating")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEditPrice(t.$index,t.row)}}},[e._v("\n                  "+e._s(e.$t("l.ChangePrice"))+"\n                ")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleRevokeSale(t.$index,t.row)}}},[e._v("\n                  "+e._s(e.$t("l.Revoke"))+"\n                ")])]}}])}),e._v(" "),e.syncState?a("el-tab-loading",{attrs:{slot:"empty",loading:e.syncState},slot:"empty"}):e._e()],1),e._v(" "),a("el-row",{staticClass:"bas-white-bg",attrs:{gutter:20}},[a("el-col",{attrs:{md:24,sm:24}},[a("el-pagination",{staticClass:"text-center",attrs:{"page-size":e.pager.pagesize,"current-page":e.pager.pagenumber,layout:"prev, pager, next",total:e.sellTotal,"hide-on-single-page":!1},on:{"current-change":e.pagerChange,"prev-click":e.prevChange,"next-click":e.nextChange}})],1),e._v(" "),a("div",{staticClass:"float-table-total"},[a("span",[e._v("\n                "+e._s(e.$t("l.TableTotal"))+" "+e._s(e.pager.total)+" "+e._s(e.$t("l.TableRecord"))+"\n              ")]),e._v(" "),a("span",{on:{click:e.reloadSellItems}},[a("i",{staticClass:"fa fa-refresh"})])])],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("p.RevokeDialogTitle"),visible:e.revokeVisible,width:"30%","before-close":e.dialogBeforClose,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.revokeVisible=t}}},[a("h6",{staticClass:"text-center"},[e._v(e._s(e.$t("p.MarketConfirmRevoke"))),a("span",[e._v(e._s(this.revokeDialog.domaintext))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("span",{staticClass:"bas-dialog-footer--tips"},[e.revokeDialog.loading?a("loading-dot",{staticStyle:{float:"left"}}):e._e(),e._v(" "),e.revokeDialog.loading?a("span",{staticClass:"small pr-3"},[e._v(e._s(e.$t("p.RevokeDialogExcutingTip")))]):e._e()],1),e._v(" "),a("el-button",{attrs:{disabled:e.revokeDialog.loading},on:{click:e.cancelRevoke}},[e._v("\n        "+e._s(e.$t("g.Cancel"))+"\n      ")]),e._v(" "),a("el-button",{attrs:{disabled:e.revokeDialog.loading},on:{click:e.confirmRevoke}},[e._v("\n        "+e._s(e.$t("g.Confirm"))+"\n      ")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.cpd.visible,width:"28%","before-close":e.cancelChangePrice,"close-on-click-modal":!1,"show-close":!0},on:{"update:visible":function(t){return e.$set(e.cpd,"visible",t)}}},[a("div",{staticClass:"bas-dg-header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("span",[e._v("修改域名")]),e._v(" "),a("span",{staticClass:"title-domain"},[e._v(e._s(e.cpd.domaintext))]),e._v(" "),a("span",[e._v("价格")])])]),e._v(" "),a("div",{staticClass:"bas-dg-body"},[a("el-input",{staticClass:"input-unit-bas",attrs:{type:"number",placeholder:e.$t("p.SaleOnDialogUnitBasPlaceholder"),"show-message":!e.cpd.validState,name:"price",error:e.cpd.error,min:e.ctrl.minprice,max:e.ctrl.maxprice,disabled:e.cpd.loading,controls:!1},on:{change:e.priceChangeValid},model:{value:e.cpd.pricevol,callback:function(t){e.$set(e.cpd,"pricevol",t)},expression:"cpd.pricevol"}},[a("div",{staticClass:"suffix",attrs:{slot:"suffix"},slot:"suffix"},[e._v("BAS")])]),e._v(" "),a("div",{staticClass:"bas-text-warning"},[e._v("\n            "+e._s(e.$t("l.DomainPriceMaxTips"))+"\n          ")]),e._v(" "),a("div",{staticClass:"bas-dialog-footer--tips"},[e.cpd.loading?a("loading-dot",{staticStyle:{float:"left"}}):e._e(),e._v(" "),e.cpd.loading?a("span",{staticClass:"small pr-3"},[e._v("\n          "+e._s(e.$t("g.TransactionWaitTips"))+"\n        ")]):e._e()],1),e._v(" "),a("el-button",{staticClass:"w-100 bas-btn-primary",attrs:{disabled:e.cpd.loading},on:{click:e.submitChangeDomainPrice}},[e._v("\n        "+e._s(e.$t("g.Confirm"))+"\n      ")])],1)])],1)},staticRenderFns:[]};var $=a("VU/8")(x,_,!1,function(e){a("Bu4q"),a("f8iq")},"data-v-f89cbf94",null);t.default=$.exports}});
//# sourceMappingURL=12.e910133e5103e1162e26.js.map