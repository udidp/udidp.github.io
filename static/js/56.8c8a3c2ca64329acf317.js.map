{"version":3,"sources":["webpack:///src/views/Market_/commit/BoughtResult.vue","webpack:///./src/views/Market_/commit/BoughtResult.vue?4430","webpack:///./src/views/Market_/commit/BoughtResult.vue"],"names":["BoughtResult","name","components","LoadingDot","computed","getTips","state","this","buyingState","$t","btnDisabled","ctrl","completed","data","transactions","methods","addTxHashItem","hash","push","updateTxHashItem","index","findIndex","el","splice","commitApprove","owner","nameHash","costWei","Error","web3State","$store","getters","chainId","wallet","spender","Object","market_api","that","token_api","on","txhash","receipt","transactionHash","err","buySendTransaction","error","gotoUpdateDNS","fullDomain","domaintext","$router","path","gotoWallet","$metamask","gotoMarket","mounted","$route","params","commitData","watch","val","old","commit_BoughtResult","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","padding","attrs","shadow","_v","_s","slot","_l","item","key","_e","disabled","click","class","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/56.8c8a3c2ca64329acf317.js","sourcesContent":["<template>\n  <div class=\"bas-gray-bg w-100\">\n    <div class=\"container bas-market-result\">\n      <div class=\"row justify-content-center align-items-center pt-5\">\n        <el-card shadow=\"never\" style=\"padding:10px 20px;\"\n          class=\"col-md-8 col-sm-10 box-card\">\n            <h3 class=\"text-center market-domain-title\">\n              {{ this.data.domaintext }}\n            </h3>\n            <p class=\"market-tips text-center bas-text-green\">\n              {{ getTips }}\n            </p>\n        </el-card>\n      </div>\n      <div class=\"row justify-content-center align-items-center\">\n        <el-card shadow=\"never\" class=\"col-md-8 col-sm-10 box-card\">\n          <div class=\"clearfix\" slot=\"header\">\n            <h4>Transaction Hash</h4>\n          </div>\n          <div v-for=\"(item, index) in transactions\" :key=\"index\" class=\"text item bas-inline-between\">\n            <div class=\"\">{{ item.hash }}</div>\n            <div v-if=\"item.state === 'loading'\">\n              <loading-dot />\n            </div>\n            <div v-else-if=\"item.state === 'success'\">\n              <i class=\"fa fa-check bas-text-green\"></i>\n            </div>\n            <div v-else-if=\"item.state === 'fail'\">\n              <i class=\"fa fa-close text-danger\"></i>\n            </div>\n          </div>\n        </el-card>\n      </div>\n      <div class=\"row justify-content-center align-items-center pb-5\">\n        <el-card shadow=\"never\" class=\"col-md-8 col-sm-10 box-card\">\n          <div class=\"w-100 bas-btn-group text-center\">\n            <button @click=\"gotoUpdateDNS\" :disabled=\"btnDisabled\"\n              class=\"w-25 mx-2 btn bas-btn-green-border\">\n              <i v-if=\"btnDisabled && this.buyingState\" class=\"fa fa-ban\"></i>\n              {{$t('p.MarketBoughtConfigurationBtn')}}\n            </button>\n            <button @click=\"gotoWallet\" :disabled=\"btnDisabled\"\n              class=\"w-25 mx-2 btn bas-btn-green-border\">\n              <i v-if=\"btnDisabled\" class=\"fa fa-ban\"></i>\n              {{$t('p.GotoMyWalletBtn')}}\n            </button>\n            <button @click=\"gotoMarket\" :disabled=\"btnDisabled\"\n              class=\"w-25 mx-2 btn\" :class=\"btnDisabled ? '' : 'bas-btn-primary'\">\n              <i v-if=\"btnDisabled\" class=\"fa fa-ban\"></i>\n              {{$t('p.GobackMarketBtn')}}\n            </button>\n          </div>\n        </el-card>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { approveTokenEmitter } from '@/web3-lib/apis/token-api'\nimport { buyFromMarket, getMarketAddress } from '@/web3-lib/apis/market-api'\nimport LoadingDot from '@/components/LoadingDot.vue'\n\nimport {getWeb3State} from '@/bizlib/web3'\nimport {approveToMarketEmitter} from '@/bizlib/web3/token-api'\nimport {buyFromSellEmitter} from '@/bizlib/web3/market-api'\n\nexport default {\n  name:\"MarketBoughtResult\",\n  components:{\n    LoadingDot\n  },\n  computed: {\n    getTips(){\n      let state = this.buyingState\n      if(state === 'approving'){\n        return this.$t('p.DomainRegistApprove')\n      }else if(state === 'confirming'){\n        return this.$t('p.DomainRegistConfirm')\n      }else if(state === 'success') {\n        return this.$t('g.OperateTipSuccess')\n      }else if(state === 'fail'){\n        return this.$t('g.OperateTipFail')\n      }\n      return ''\n    },\n    btnDisabled(){\n      return !this.ctrl.completed\n    }\n  },\n  data() {\n    return {\n      ctrl:{\n        completed: false\n      },\n      buyingState:'approving',//confirm\n      data: {},\n      transactions:[]\n    }\n  },\n  methods: {\n    addTxHashItem(hash, state) {\n      this.transactions.push({ hash,state })\n    },\n    updateTxHashItem(hash, state) {\n      let index = this.transactions.findIndex(el => el.hash === hash)\n      if (index >= 0) {\n        this.transactions.splice(index, 1, { hash, state })\n      }\n    },\n    commitApprove(){\n      let data = this.data;\n      if(!data.owner || !data.nameHash || !data.costWei){\n        throw new Error('illegal arguments.')\n        return;\n      }\n      const web3State = this.$store.getters['web3State']\n      let chainId = web3State.chainId;\n      let wallet = web3State.wallet;\n\n      console.log(\">>>>>>>>>>Approve>>>>>>>\", data.owner, data.costWei, chainId, wallet)\n      \n      let spender = getMarketAddress(chainId)\n      console.log('market address', spender)\n      let that = this;\n      approveTokenEmitter(spender, data.costWei, chainId, wallet).on('transactionHash', txhash => {\n        that.buyingState = 'approving'\n        that.addTxHashItem(txhash, 'loading')\n        console.log('that.transactions>>>>>', that.transactions)\n      }).on('receipt', (receipt) => {\n        console.log('receipt IN COMMIT &&&&&&&&', receipt.status)\n        that.buyingState = 'confirming'\n        that.updateTxHashItem(receipt.transactionHash, 'success')\n      }).on('error', (err, receipt) => {\n        that.buyingState = 'fail'\n        if (receipt) {\n          that.updateTxHashItem(receipt.transactionHash, 'fail')\n        }\n      })\n    },\n    buySendTransaction() {\n      let data = this.data;\n      console.log('excute buying>>>>>Send>', data)\n      const web3State = this.$store.getters['web3State']\n      let chainId = web3State.chainId;\n      let wallet = web3State.wallet;\n      let that = this;\n      try {\n        buyFromMarket(data.nameHash, data.owner, data.costWei, chainId, wallet)\n        .on('transactionHash', txhash => {\n          that.buyingState = 'confirming'\n          that.addTxHashItem(txhash, 'loading')\n        }).on('receipt', (receipt) => {\n          that.updateTxHashItem(receipt.transactionHash, 'success')\n          that.buyingState = 'success'\n          that.ctrl.completed = true\n        }).on('error', (err, receipt) => {\n          that.buyingState = 'fail'\n          if (receipt) {\n            that.updateTxHashItem(receipt.transactionHash, 'fail')\n          }\n        })\n      } catch (error) {\n        console.error(error)\n      }\n    },\n    gotoUpdateDNS(){\n      let fullDomain = this.data.domaintext\n      console.log(fullDomain)\n      if(fullDomain){\n        this.$router.push({path:`/domain/dnsupdate/${fullDomain}`})\n      }\n    },\n    gotoWallet(){\n      if(this.$store.getters['metaMaskDisabled']){\n        this.$metamask()\n        return;\n      }\n      this.$router.push({name:'wallet.layout'})\n    },\n    gotoMarket(){\n       this.$router.push({name:'market.index'})\n    }\n  },\n  mounted() {\n    this.data = this.$route.params.commitData;\n    console.log('commitData', this.data)\n    this.commitApprove()\n  },\n  watch: {\n    buyingState: function (val, old) {\n      if (old === 'approving' && val === 'confirming'){\n        this.buySendTransaction()\n      }\n    }\n  },\n}\n</script>\n<style scoped>\n.market-domain-title {\n  font-size: 36px;\n}\n.bas-market-result > div.el-card__body {\n  padding: .25rem 20px;\n}\n.bas-market-result .el-card {\n  border: none;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/Market_/commit/BoughtResult.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bas-gray-bg w-100\"},[_c('div',{staticClass:\"container bas-market-result\"},[_c('div',{staticClass:\"row justify-content-center align-items-center pt-5\"},[_c('el-card',{staticClass:\"col-md-8 col-sm-10 box-card\",staticStyle:{\"padding\":\"10px 20px\"},attrs:{\"shadow\":\"never\"}},[_c('h3',{staticClass:\"text-center market-domain-title\"},[_vm._v(\"\\n            \"+_vm._s(this.data.domaintext)+\"\\n          \")]),_vm._v(\" \"),_c('p',{staticClass:\"market-tips text-center bas-text-green\"},[_vm._v(\"\\n            \"+_vm._s(_vm.getTips)+\"\\n          \")])])],1),_vm._v(\" \"),_c('div',{staticClass:\"row justify-content-center align-items-center\"},[_c('el-card',{staticClass:\"col-md-8 col-sm-10 box-card\",attrs:{\"shadow\":\"never\"}},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('h4',[_vm._v(\"Transaction Hash\")])]),_vm._v(\" \"),_vm._l((_vm.transactions),function(item,index){return _c('div',{key:index,staticClass:\"text item bas-inline-between\"},[_c('div',{},[_vm._v(_vm._s(item.hash))]),_vm._v(\" \"),(item.state === 'loading')?_c('div',[_c('loading-dot')],1):(item.state === 'success')?_c('div',[_c('i',{staticClass:\"fa fa-check bas-text-green\"})]):(item.state === 'fail')?_c('div',[_c('i',{staticClass:\"fa fa-close text-danger\"})]):_vm._e()])})],2)],1),_vm._v(\" \"),_c('div',{staticClass:\"row justify-content-center align-items-center pb-5\"},[_c('el-card',{staticClass:\"col-md-8 col-sm-10 box-card\",attrs:{\"shadow\":\"never\"}},[_c('div',{staticClass:\"w-100 bas-btn-group text-center\"},[_c('button',{staticClass:\"w-25 mx-2 btn bas-btn-green-border\",attrs:{\"disabled\":_vm.btnDisabled},on:{\"click\":_vm.gotoUpdateDNS}},[(_vm.btnDisabled && this.buyingState)?_c('i',{staticClass:\"fa fa-ban\"}):_vm._e(),_vm._v(\"\\n            \"+_vm._s(_vm.$t('p.MarketBoughtConfigurationBtn'))+\"\\n          \")]),_vm._v(\" \"),_c('button',{staticClass:\"w-25 mx-2 btn bas-btn-green-border\",attrs:{\"disabled\":_vm.btnDisabled},on:{\"click\":_vm.gotoWallet}},[(_vm.btnDisabled)?_c('i',{staticClass:\"fa fa-ban\"}):_vm._e(),_vm._v(\"\\n            \"+_vm._s(_vm.$t('p.GotoMyWalletBtn'))+\"\\n          \")]),_vm._v(\" \"),_c('button',{staticClass:\"w-25 mx-2 btn\",class:_vm.btnDisabled ? '' : 'bas-btn-primary',attrs:{\"disabled\":_vm.btnDisabled},on:{\"click\":_vm.gotoMarket}},[(_vm.btnDisabled)?_c('i',{staticClass:\"fa fa-ban\"}):_vm._e(),_vm._v(\"\\n            \"+_vm._s(_vm.$t('p.GobackMarketBtn'))+\"\\n          \")])])])],1)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-16df8a3f\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/Market_/commit/BoughtResult.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-16df8a3f\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./BoughtResult.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./BoughtResult.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./BoughtResult.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-16df8a3f\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./BoughtResult.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-16df8a3f\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/Market_/commit/BoughtResult.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}