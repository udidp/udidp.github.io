webpackJsonp([21],{"/Bvj":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("Xxa5"),i=e.n(s),r=e("exGp"),l=e.n(r),n=e("Dd8w"),o=e.n(n),c=(e("LF9K"),e("0xDb")),m=e("82Js"),u=e("JX3P"),p=e("Xyu6"),d=e("7Hl/"),v=e("c2YU"),h={name:"MailRegistIndex",components:{CircleLoading:d.a},computed:o()({toggleIconClass:function(){return this.mailPoper.visible?"fa-chevron-up":"fa-chevron-down"},showMailtext:function(){return""===this.mailDomainHash||null===this.mailDomainText?"":"@"+this.mailDomainText},showErrors:function(){return Boolean(this.inputctrl.message)},domainMails:function(){var t=this.mailPoper.filterkey;return t?this.mailassets.filter(function(a){return a.domaintext.includes(t.trim())}):this.mailassets}},Vuex.mapState({unitBas:function(t){return Object(c.C)(t.dapp.mailRegGas||2)},maxMailRegYears:function(t){return t.dapp.maxMailRegYears},mailassets:function(t){return t.dapp.mailassets?t.dapp.mailassets:[]}})),data:function(){return{years:1,mailDomainText:"",mailDomainHash:"",mailName:"",mailAlias:"",mailPoper:{visible:!1,loading:!1,filterkey:""},inputctrl:{message:""},ctrl:{loading:!1,timeoutId:null,closeable:!1,timeout:15}}},methods:{selectYearsHandle:function(t){this.years=t<=0||t>this.maxMailRegYears?this.maxMailRegYears:t},mailPoperToggle:function(){this.mailPoper.visible=!this.mailPoper.visible},reloadMailAssets:function(){var t=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.mailPoper.loading=!0,a.next=3,t.$store.dispatch("dapp/loadPublicMailDomains");case 3:t.mailPoper.loading=!1;case 4:case"end":return a.stop()}},a,t)}))()},hideMailAssetPoper:function(){this.mailPoper.visible=!1},SelectedMailDomainHandle:function(t,a){this.mailDomainText=t,this.mailDomainHash=a,this.mailPoper.visible=!1},loadPublicMailDomainOnMount:function(){var t=this;return l()(i.a.mark(function a(){var e;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:(e=t.$store.state.dapp.mailassets)&&e.length&&(t.mailDomainText=e[0].domaintext,t.mailDomainHash=e[0].hash);case 2:case"end":return a.stop()}},a,t)}))()},setCloseableFalse:function(){this.ctrl.closeable=!1,this.ctrl.loading=!1},submitMailName:function(){var t=this;return l()(i.a.mark(function a(){var e,s,r,l,n,o,c,p,d,h,f;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.$store.getters.metaMaskDisabled){a.next=3;break}return t.$metamask(),a.abrupt("return");case 3:if(!t.inputctrl.message){a.next=6;break}return t.$message(t.$basTip.error(t.inputctrl.message)),a.abrupt("return");case 6:if(e=t.$store.getters.web3State,s=e.chainId,r=e.wallet,l=t.mailDomainText,n=t.mailDomainHash,o=t.mailName,c=t.mailAlias,p="",""!==o&&o.trim().length&&n){a.next=18;break}return p=t.$t("code.888888",{text:t.$t("l.ApplyMailNameLabel")}),t.$message(t.$basTip.error(p)),a.abrupt("return");case 18:if(!Object(v.a)(o)){a.next=22;break}return d=t.$t("code."+u.t,{mailname:o}),t.$message(t.$basTip.error(d)),a.abrupt("return");case 22:return h=t.years,a.prev=24,t.ctrl.loading=!0,a.next=28,Object(m.l)(n,o,h,s,r);case 28:(f=a.sent).mailalias=c,f.mailhash,t.ctrl.loading=!1,t.$router.push({path:"/mail/registing/"+l+"/"+h+"/"+o,name:"mail.registing",params:{domaintext:l,years:h,mailname:o,commitData:f}}),a.next=64;break;case 35:a.prev=35,a.t0=a.catch(24),t.ctrl.loading=!1,a.t1=a.t0,a.next=a.t1===u.F?41:a.t1===u.l?41:a.t1===u.q?44:a.t1===u.u?47:a.t1===u.z?50:a.t1===u.n?50:a.t1===u.e?50:a.t1===u.v?50:a.t1===u.z?50:52;break;case 41:return p=t.$t("code."+a.t0),t.$message(t.$basTip.error(p)),a.abrupt("return");case 44:return p=t.$t("code."+a.t0,{mailname:o}),t.$message(t.$basTip.error(p)),a.abrupt("return");case 47:return p=t.$t("code."+a.t0,{domaintext:l}),t.$message(t.$basTip.error(p)),a.abrupt("return");case 50:return a.abrupt("return");case 52:return a.abrupt("break",53);case 53:if(a.t0.code!==u.G){a.next=59;break}return p=t.$t("code."+a.t0.code),t.$message(t.$basTip.error(p)),a.abrupt("return");case 59:if(!a.t0.message.includes(u.y)){a.next=63;break}return p=t.$t("code.-32603"),t.$message(t.$basTip.error(p)),a.abrupt("return");case 63:case 64:case"end":return a.stop()}},a,t,[[24,35]])}))()}},beforeMount:function(){var t=this;return l()(i.a.mark(function a(){var e;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$store.dispatch("dapp/fillPublicMailDomains");case 2:(e=t.$store.state.dapp.mailassets)&&e.length&&(t.mailDomainText=e[0].domaintext,t.mailDomainHash=e[0].hash);case 4:case"end":return a.stop()}},a,t)}))()},mounted:function(){var t=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:setTimeout(l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.loadPublicMailDomainOnMount();case 2:case"end":return a.stop()}},a,t)})),500);case 1:case"end":return a.stop()}},a,t)}))()},watch:{mailName:function(t,a){var e=this,s=this;if(""!==t&&t!==a){var r=t.trim()+"@"+this.mailDomainText,n=this.$store.getters.web3State.chainId;this.ctrl.timeoutId&&clearTimeout(this.ctrl.timeoutId),this.ctrl.timeoutId=setTimeout(l()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Object(p.b)(r,n);case 4:(a=t.sent).state?a.mail.abandoned?s.inputctrl.message=s.$t("code."+u.p,{text:r}):s.inputctrl.message=s.$t("code."+u.q,{text:r}):s.inputctrl.message="",t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),s.inputctrl.message="";case 13:case"end":return t.stop()}},t,e,[[1,9]])})),1500)}else this.inputctrl.message=""},mailDomainText:function(t,a){var e=this,s=this.mailName;if(""!==t&&t!==a&&""!==s){var r=s.trim()+"@"+t,n=this.$store.getters.web3State.chainId;this.ctrl.timeoutId&&clearTimeout(this.ctrl.timeoutId);var o=this;this.ctrl.timeoutId=setTimeout(l()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Object(p.b)(r,n);case 4:(a=t.sent).state?a.mail.abandoned?o.inputctrl.message=o.$t("code."+u.p,{text:r}):o.inputctrl.message=o.$t("code."+u.q,{text:r}):o.inputctrl.message="",t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),o.inputctrl.message="";case 12:case"end":return t.stop()}},t,e,[[1,8]])})),500)}else this.inputctrl.message=""},mailassets:function(t,a){t&&t.length&&(this.mailDomainText=t[0].domaintext,this.mailDomainHash=t[0].hash)},"ctrl.loading":{handler:function(t,a){var e=this;if(t&&!a){var s=1e3*this.ctrl.timeout;setTimeout(function(){e.ctrl.closeable=!0},s)}},immediate:!0}}},f={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mail-regist-wrapper"},[e("div",{staticClass:"container inner-center-container"},[e("div",{staticClass:"row justify-content-center pt-5 pb-5"},[e("div",{staticClass:"bmail-box-auto mail-content-card"},[t._m(0),t._v(" "),e("div",{staticClass:"header-title"},[e("h5",{staticClass:"mail-regist-title"},[t._v("\n             "+t._s(t.$t("l.ApplyMailNameLabel"))+"\n            ")])]),t._v(" "),e("div",{staticClass:"mail-regist-form-wrapper"},[e("el-form",{staticClass:"mail-regist-form",attrs:{"label-position":"top","label-width":"120px"}},[e("div",{staticClass:"mail-input-container"},[e("el-form-item",{staticClass:"w-100",attrs:{"show-message":"false"}},[e("div",{staticClass:"bas-mail-apply"},[e("el-input",{staticClass:"mail-input",attrs:{placeholder:t.$t("p.MailRegistInputPlaceholder"),type:"text"},model:{value:t.mailName,callback:function(a){t.mailName=a},expression:"mailName"}}),t._v(" "),e("div",{staticClass:"mail-domain--suffix-wrapper",attrs:{slot:"suffix"},slot:"suffix"},[e("div",{staticClass:"mail-domaintext-show"},[e("span",[t._v(t._s(t.showMailtext))])]),t._v(" "),e("div",{staticClass:"mail-toggle-icon",on:{click:t.mailPoperToggle}},[e("i",{staticClass:"fa",class:t.toggleIconClass})])])],1)]),t._v(" "),t.mailPoper.visible?e("div",{staticClass:"mail-domain--poper"},[e("div",{staticClass:"row row-container"},[Boolean(t.domainMails)&&t.domainMails.length?t._e():e("div",{staticStyle:{"font-size":"14px",padding:".25rem .5rem"}},[e("span",[t._v(t._s(t.$t("p.DomainSearchNoResultTip")))])]),t._v(" "),t._l(t.domainMails,function(a,s){return e("div",{key:s,staticClass:"bas-col-20",on:{click:function(e){return t.SelectedMailDomainHandle(a.domaintext,a.hash)}}},[e("p",{staticClass:"mailtext"},[t._v(t._s("@"+a.domaintext))])])})],2),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"mail-domain--poper-footbar"},[e("el-input",{staticClass:"sub-filter-input",attrs:{placeholder:t.$t("p.MailPublicFilterKeyTips"),disabled:t.mailPoper.loading},model:{value:t.mailPoper.filterkey,callback:function(a){t.$set(t.mailPoper,"filterkey",a)},expression:"mailPoper.filterkey"}},[e("div",{staticClass:"mail-search",attrs:{slot:"suffix"},slot:"suffix"},[e("i",{staticClass:"fa fa-search"})])]),t._v(" "),e("el-button",{staticClass:"border-right",attrs:{disabled:t.mailPoper.loading,type:"default"},on:{click:t.reloadMailAssets}},[t._v("\n                      "+t._s(t.$t("g.Refresh"))+"\n                    ")]),t._v(" "),e("div"),t._v(" "),e("el-button",{attrs:{type:"default"},on:{click:t.hideMailAssetPoper}},[t._v("\n                      "+t._s(t.$t("l.ChevronUp"))+"\n                    ")])],1)]):t._e(),t._v(" "),Boolean(t.inputctrl.message)||Boolean(t.mailName)?e("div",{staticClass:"mailname-wrapper",class:Boolean(t.inputctrl.message)?"bas-warn-box":"bas-grass-box"},[e("div",[t._v("\n                    "+t._s(t.inputctrl.message?t.inputctrl.message:t.$t("p.MailRegistNameWarnTip"))+"\n                  ")])]):t._e()],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("l.MailAlias")}},[e("el-input",{staticClass:"mail-alias",attrs:{placeholder:t.$t("p.MailRegistAliasPlaceholder")},model:{value:t.mailAlias,callback:function(a){t.mailAlias=a},expression:"mailAlias"}})],1),t._v(" "),e("div",{staticClass:"purchase-label-wrapper pt-1 pb-1"},[e("div",{staticClass:"bmail-form-label"},[t._v(t._s(t.$t("l.PurchaseYears")))])]),t._v(" "),e("div",{staticClass:"years-select-container"},t._l(t.maxMailRegYears,function(a){return e("div",{key:a,staticClass:"bmail-year-selector"},[e("div",{staticClass:"selector-wrapper"},[e("div",{staticClass:"year-inner-box",class:a==t.years?"year-active":"",on:{click:function(e){return t.selectYearsHandle(a)}}},[a==t.years?e("div",[e("div",{staticClass:"year-active-icon"})]):t._e(),t._v(" "),e("div",{staticClass:"bas-total"},[t._v("\n                        "+t._s(a*parseFloat(t.unitBas))+"\n                      ")]),t._v(" "),e("div",{staticClass:"mail-years"},[e("span",[t._v(t._s(a))]),t._v(" "),e("span",[t._v(t._s(1===a?t.$t("l.Year"):t.$t("l.Years")))])])])])])}),0)],1)],1),t._v(" "),e("div",{staticClass:"mail-regist-btns"},[e("el-button",{staticClass:"bas-btn-primary w-100",attrs:{type:"primary"},on:{click:t.submitMailName}},[t._v("\n              "+t._s(t.$t("l.RegistBtn"))+"\n            ")])],1)])])]),t._v(" "),t._m(1),t._v(" "),e("el-dialog",{staticClass:"bas-dialog-nobody",attrs:{width:"320px","close-on-click-modal":!1,"show-close":t.ctrl.closeable,"before-close":t.setCloseableFalse,visible:t.ctrl.loading,top:"35vh"},on:{"update:visible":function(a){return t.$set(t.ctrl,"loading",a)}}},[e("div",{staticClass:"bas-wrapper--valid",attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"logo-container"},[e("CircleLoading")],1),t._v(" "),e("div",{staticClass:"bas-dialog-content"},[e("span",{staticClass:"tip-prefix"},[t._v("\n          "+t._s(t.$t("g.ValidateOnBlockChain"))+"\n        ")]),t._v(" "),e("span",{staticClass:"tip-green"},[t._v("\n           "+t._s(t.mailName)+t._s(t.showMailtext)+"\n        ")])]),t._v(" "),Boolean(t.ctrl.closeable)?e("div",[e("p",{staticClass:"small"},[t._v("\n          "+t._s(t.$t("g.RequestTimeoutOverTip",{ts:t.ctrl.timeout}))+"\n        ")])]):t._e(),t._v(" "),Boolean(t.ctrl.closeable)?e("div",{staticClass:"text-center"},[e("el-button",{staticClass:"w-25",attrs:{size:"mini"},on:{click:t.setCloseableFalse}},[t._v("\n          "+t._s(t.$t("l.Cancel"))+"\n        ")])],1):t._e()])])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"header-logo"},[a("img",{staticClass:"img-fluid",attrs:{src:"/static/icons/logo_header_blk.png"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticStyle:{height:"1.5rem"}})])}]};var b=e("VU/8")(h,f,!1,function(t){e("I2B2"),e("MIg8")},null,null);a.default=b.exports},I2B2:function(t,a){},MIg8:function(t,a){}});
//# sourceMappingURL=21.39bcb75551fdac1b8468.js.map