webpackJsonp([25],{EYB0:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("Xxa5"),n=t.n(r),i=t("exGp"),s=t.n(i),o=t("woOf"),l=t.n(o),c=t("Dd8w"),d=t.n(c),h=t("0xDb"),u=t("JX3P"),b=t("Ruar"),g=t("82Js"),p=t("U/4D"),m=t("g1m8"),v=t("J3VU"),f={name:"EWalletMailList",components:{LoadingDot:m.a,ElTabLoading:v.a},computed:d()({},Vuex.mapState({items:function(e){return e.ewallet.mails.filter(function(e){return!e.abandoned})},unitBas:function(e){return Object(h.C)(e.dapp.mailRegGas)},wallet:function(e){return e.dapp.wallet},chainId:function(e){return e.dapp.chainId}}),Vuex.mapGetters({loading:"ewallet/mailsLoading"}),{itemTotal:function(){return this.items.length}}),data:function(){return{txTimeout:30,confirm:{visible:!1,loading:!1,contents:"",title:"",hash:"",fulltext:""},abandon:{visible:!1,loading:!1,hash:"",mailtext:"",owner:""},recharge:{visible:!1,loading:!1,closeable:!0,expiration:0,expirationText:"",moreshow:!1,chargeYears:0,maxchargeYears:0,state:"",items:[],mailtext:"",mailhash:"",owner:""},transState:"",yearItems:[{y:5,bas:10},{y:4,bas:8},{y:3,bas:6},{y:2,bas:4},{y:1,bas:2}]}},methods:{domainMailFormat:function(e,a,t){return"@"+t},expireFormat:function(e,a,t){return t?Object(h.h)(t):""},hashShort:function(e,a,t){return Object(h.g)(t)},mailtextShow:function(e,a,t){var r=Object(h.g)(e.hash);return e.aliasName?""+e.aliasName:""+r},gotoDetail:function(){},toggleMoreshow:function(){this.recharge.moreshow=!this.recharge.moreshow},hideRechargeDialog:function(){this.recharge=l()({},this.recharge,{visible:!1,loading:!1,closeable:!0,expiration:0,expirationText:"",chargeYears:0,maxchargeYears:0,mailtext:"",mailhash:"",owner:""})},recharge4Mail:function(e,a){if(a.hash){a.domaintext;var t=a.aliasName?a.aliasName:Object(h.g)(a.hash),r=(a.expiration,a.canRechargeYear||Object(h.t)(a.expiration)),n=parseFloat(this.unitBas);this.recharge=l()({},this.recharge,{visible:!0,loading:!1,expiration:a.expiration,expirationText:Object(h.h)(a.expiration),chargeYears:r,maxchargeYears:r,items:this.yearItems.filter(function(e){return e.y<=r}).map(function(e){return e.bas=parseFloat(e.y)*n,e}),mailtext:t,mailhash:a.hash,owner:a.owner})}},selectedYear:function(e){this.recharge.loading||(this.recharge.chargeYears=e)},cancelAbandonDialog:function(){this.abandon=Object({},{visible:!1,loading:!1,hash:"",mailtext:"",owner:""})},abandonMail:function(e,a){var t=a.aliasName?a.aliasName:Object(h.g)(a.hash);this.abandon=l()({},{visible:!0,loading:!1,hash:a.hash,mailtext:t,owner:a.owner})},submitAbandon:function(){var e=this;return s()(n.a.mark(function a(){var t,r,i,s,o,l,c,d;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.$store.getters.metaMaskDisabled){a.next=3;break}return e.$metamask(),a.abrupt("return");case 3:if(t=e.$store.getters.web3State,r=t.chainId,i=t.wallet,s=e.abandon.owner,o=e.abandon.mailtext,l=e.abandon.hash){a.next=12;break}return a.abrupt("return");case 12:return a.prev=12,e.abandon.loading=!0,a.next=16,Object(g.a)(l,r,i);case 16:c=a.sent,e.abandon=Object({},{visible:!1,loading:!1,hash:"",mailtext:"",owner:""}),e.$store.dispatch("ewallet/updataMyMailProps",c),a.next=46;break;case 22:a.prev=22,a.t0=a.catch(12),e.abandon.loading=!1,d="",a.t1=a.t0,a.next=a.t1===u.z?29:a.t1===u.F?31:a.t1===u.a?34:a.t1===u.s?37:40;break;case 29:return a.abrupt("return");case 31:return d=e.$t("code."+a.t0),e.$message(e.$basTip.error(d)),a.abrupt("return");case 34:return d=e.$t("code.ex",{wallet:i,owner:s}),e.$message(e.$basTip.error(d)),a.abrupt("return");case 37:return d=e.$t("code."+a.t0,{text:o}),e.$message(e.$basTip.error(d)),a.abrupt("return");case 40:return a.abrupt("break",41);case 41:if(a.t0.code!==u.G){a.next=45;break}return d=e.$t("code."+u.G),e.$message(e.$basTip.error(d)),a.abrupt("return");case 45:case 46:case"end":return a.stop()}},a,e,[[12,22]])}))()},gotoUpdateMailInfo:function(e,a){var t=a.hash,r=a.domaintext;t&&r&&this.$router.push({path:"/mail/detail_conf",name:"mail.detailconf",query:{hash:t,domaintext:r}})},reloadRecords:function(){var e=this.$store.getters.web3State;e.chainId&&e.wallet&&this.$store.dispatch("ewallet/loadEWalletMails",e)},submitRechargeMail:function(){var e=this;return s()(n.a.mark(function a(){var t,r,i,o,l,c,d,h,p,m;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.$store.getters.metaMaskDisabled){a.next=3;break}return e.$metamask(),a.abrupt("return");case 3:return e.recharge.owner,t=e.$store.getters.web3State,r=e.recharge.chargeYears,i=e.recharge.mailhash,o=e.recharge.mailtext,l=t.chainId,c=t.wallet,d=e,h="",a.prev=12,a.next=15,Object(g.k)(i,r,l,c);case 15:p=a.sent,Object(b.a)(p.spender,p.costwei,l,c).on("transactionHash",function(a){d.recharge.loading=!0,d.recharge.closeable=!1;var t=d.txTimeout;setTimeout(s()(n.a.mark(function a(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.$message(d.$basTip.error(d.$t("g.MetaMaskTxSlowTimeoutTip",{ts:t}))),d.recharge.closeable=!0;case 2:case"end":return e.stop()}},a,e)})),1e3*t)}).on("receipt",function(){var a=s()(n.a.mark(function a(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(g.e)(i,r,l,c);case 3:e.sent,d.$store.dispatch("ewallet/updateMailInfo",{hash:i,chainId:l}),d.recharge.loading=!1,d.hideRechargeDialog();case 8:case"end":return e.stop()}},a,e)}));return function(e){return a.apply(this,arguments)}}()).on("error",function(e,a){if(d.recharge.loading=!1,d.recharge.closeable=!0,e.code===u.G)return h=d.$t("code."+u.G),void d.$message(d.$basTip.error(h))}),a.next=37;break;case 20:a.prev=20,a.t0=a.catch(12),m="",a.t1=a.t0,a.next=a.t1===u.l?26:a.t1===u.F?26:a.t1===u.s?29:a.t1===u.a?32:35;break;case 26:return m=e.$t("code.${ex}"),e.$message(e.$basTip(m)),a.abrupt("return");case 29:return m=e.$t("code.${ex}",{text:o}),e.$message(e.$basTip(m)),a.abrupt("return");case 32:return m=e.$t("code.${ex}",{wallet:c,owner:""}),e.$message(e.$basTip(m)),a.abrupt("return");case 35:return a.abrupt("break",37);case 37:case"end":return a.stop()}},a,e,[[12,20]])}))()}},beforeMount:function(){var e=this;return s()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.$store.dispatch("ewallet/fillEWalletMails");case 1:case"end":return a.stop()}},a,e)}))()},mounted:function(){var e=this;return s()(n.a.mark(function a(){var t;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:(t=e.$store.getters.web3State).chainId&&t.wallet&&e.$store.dispatch("ewallet/loadEWalletMails",t);case 3:case"end":return a.stop()}},a,e)}))()},watch:{wallet:function(e,a){Object(p.a)(this.chainId)&&e&&this.$store.dispatch("ewallet/loadEWalletMails",{chainId:this.chainId,wallet:e})},chainId:function(e,a){Object(p.a)(e)&&this.wallet&&this.$store.dispatch("ewallet/loadEWalletMails",{chainId:e,wallet:this.wallet})}}},w={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticStyle:{width:"100%"},attrs:{type:"index",data:e.items},on:{"cell-click":e.gotoDetail}},[t("el-table-column",{attrs:{prop:"fulltext",index:"hash",formatter:e.mailtextShow,label:e.$t("l.BMailAccount"),width:"180"}}),e._v(" "),t("el-table-column",{attrs:{prop:"domaintext",index:"domain",formatter:e.domainMailFormat,label:e.$t("l.EWalletDomainMailServers"),width:"160"}}),e._v(" "),t("el-table-column",{attrs:{prop:"expiration",sortable:"",label:e.$t("l.ExpiredDate"),formatter:e.expireFormat,width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"bca","header-align":"center",align:"left",label:e.$t("l.BMailBCALabel")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"mail-public-key"},[e._v("\n           "+e._s(a.row.bca)+"\n         ")])]}}])}),e._v(" "),t("el-table-column",{attrs:{"header-align":"center",index:"operate",width:"200","class-name":"el-tbc-operator",align:"right",label:e.$t("l.Operating")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-dropdown",[t("el-button",{attrs:{size:"mini",type:"default"}},[e._v("\n            "+e._s(e.$t("l.MoreOperation"))+" "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:a.row,disabled:a.row.abandoned},nativeOn:{click:function(t){return e.gotoUpdateMailInfo(a.$index,a.row)}}},[e._v("\n              "+e._s(e.$t("l.UpdateTagLabel"))+"\n            ")]),e._v(" "),t("el-dropdown-item",{attrs:{disabled:a.row.abandoned,command:a.row},nativeOn:{click:function(t){return e.abandonMail(a.$index,a.row)}}},[e._v("\n              "+e._s(e.$t("l.AbandonLabel"))+"\n            ")])],1)],1),e._v(" "),t("el-button",{attrs:{size:"mini",disabled:!Boolean(a.row.canRechargeYear),type:Boolean(a.row.canRechargeYear)?"primary":"default"},on:{click:function(t){return e.recharge4Mail(a.$index,a.row)}}},[e._v("\n          "+e._s(e.$t("l.RechargeLabel"))+"\n        ")])]}}])}),e._v(" "),e.loading?t("el-tab-loading",{attrs:{slot:"empty",loading:e.loading},slot:"empty"}):e._e(),e._v(" "),e.loading&&e.items.length>0?t("el-tab-loading",{attrs:{slot:"append",loading:e.loading},slot:"append"}):e._e()],1),e._v(" "),t("el-row",{staticClass:"bg-white",staticStyle:{margin:"0px"},attrs:{gutter:20}},[t("div",{staticClass:"bg-white",staticStyle:{height:"25px"}}),e._v(" "),t("div",{staticClass:"float-table-total"},[t("span",[e._v("\n        "+e._s(e.$t("l.TableTotal"))+" "+e._s(e.itemTotal)+" "+e._s(e.$t("l.TableRecord"))+"\n      ")]),e._v(" "),t("span",{on:{click:e.reloadRecords}},[t("i",{staticClass:"fa fa-refresh"})])])]),e._v(" "),t("el-dialog",{attrs:{width:"25%","close-on-click-modal":!1,"show-close":!e.abandon.loading,"before-close":e.cancelAbandonDialog,visible:e.abandon.visible,top:"35vh","custom-class":"bas-dialog"},on:{"update:visible":function(a){return e.$set(e.abandon,"visible",a)}}},[t("div",{staticClass:"bas-dg-header",attrs:{slot:"title"},slot:"title"}),e._v(" "),t("div",{staticClass:"bas-dg-body"},[t("div",{staticClass:"abandon-title"},[t("span",[e._v(e._s(e.$t("p.MailAbandonDialogTitlePrefix")))]),e._v(" "),t("span",{staticClass:"mail-name"},[e._v(e._s(e.abandon.mailtext))]),e._v(" "),t("span",[e._v(e._s(e.$t("p.MailAbandonDialogTitleSuffix")))])]),e._v(" "),t("div",{staticClass:"text-center"},[t("span",{staticClass:"bas-dg-gray-tips"},[e._v("\n          "+e._s(e.$t("p.MailAbandonDialogWarnTip"))+"\n        ")])]),e._v(" "),t("div",{staticClass:"text-center"},[t("el-button",{staticClass:"bas-w-65 bas-btn-primary btn-abandon",attrs:{disabled:e.abandon.loading,type:"primary"},on:{click:e.submitAbandon}},[t("div",[e.abandon.loading?t("LoadingDot"):e._e()],1),e._v("\n          "+e._s(e.abandon.loading?e.$t("l.Transactioning"):e.$t("l.ConfirmAbandon"))+"\n        ")])],1)])]),e._v(" "),t("el-dialog",{attrs:{width:"40%","close-on-click-modal":!1,"show-close":e.recharge.closeable,"before-close":e.hideRechargeDialog,visible:e.recharge.visible},on:{"update:visible":function(a){return e.$set(e.recharge,"visible",a)}}},[t("div",{staticClass:"recharge-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"title"},[t("label",[e._v(e._s(e.$t("l.MailLabel"))+":")]),e._v(" "),t("span",[e._v(e._s(e.recharge.mailtext))])]),e._v(" "),t("div",{staticClass:"expiration-tip"},[t("span",[e._v("\n         "+e._s(e.$t("p.MailRechargeDialogExpirationTip",{expireDate:e.recharge.expirationText}))+"\n        ")])])]),e._v(" "),t("div",{staticClass:"container"},[t("div",{staticClass:"row"},e._l(e.recharge.items,function(a,r){return t("div",{key:r,staticClass:"col-4",class:r>=3&&Boolean(!e.recharge.moreshow)?"d-none":"",on:{click:function(t){return e.selectedYear(a.y)}}},[t("div",{staticClass:"clearfix recharge-year-box",class:a.y===e.recharge.chargeYears?"box-selected":""},[t("div",{staticClass:"inner-box"},[t("div",{staticClass:"year-box-inline"},[t("span",[e._v(e._s(e.$t("l.RechargeY"+a.y)))])]),e._v(" "),t("div",{staticClass:"year-box-inline"},[t("span",{staticClass:"bas-unit"},[e._v(e._s(a.bas))])])])])])}),0),e._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"bas-inline-between"},[t("div",{staticClass:"max-tip"},[e._v("\n            "+e._s(e.$t("p.MailRechargeMaxYearsComments",{year:e.recharge.maxchargeYears,unit:1==e.recharge.maxchargeYears?e.$t("g.EnumTSYear"):e.$t("g.EnumTSYears")}))+"\n          ")]),e._v(" "),t("div",{staticClass:"more-toggle",on:{click:e.toggleMoreshow}},[t("span",[t("div",{staticClass:"fa",class:e.recharge.moreshow?"fa-chevron-up":"fa-chevron-down"}),e._v("\n              "+e._s(e.$t("l.MoreChargeYears"))+"\n            ")])])])])]),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",{staticClass:"container text-center"},[t("el-button",{staticClass:"w-25 bas-btn-primary",attrs:{type:"primary",disabled:e.recharge.loading},on:{click:e.submitRechargeMail}},[t("div",{staticStyle:{position:"relative"}},[e.recharge.loading?t("LoadingDot"):e._e()],1),e._v("\n           "+e._s(e.recharge.loading?e.$t("l.RechargingTip"):e.$t("l.ConfirmRechargeBtn"))+"\n        ")])],1)])])],1)},staticRenderFns:[]};var x=t("VU/8")(f,w,!1,function(e){t("r19Q"),t("TLKX")},null,null);a.default=x.exports},TLKX:function(e,a){},r19Q:function(e,a){}});
//# sourceMappingURL=25.3055b28850cac56630ac.js.map