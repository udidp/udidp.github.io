webpackJsonp([19],{"M/Ax":function(t,a){},eyOX:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("Xxa5"),r=e.n(s),i=e("exGp"),n=e.n(i),o=e("woOf"),c=e.n(o),l=e("UQqG"),p=e("rFtf"),m=e("BtOs"),u=e("2pnt"),d=e("0xDb"),b={name:"DomainRegistSub",data:function(){return{domain:"",years:1,hasError:!1,unitPrice:4,topData:{domain:"",owner:"",expire:"",customPrice:4,openApplied:!0},configs:{rareGas:5e3,topGas:20,subGas:4,customedPriceGas:100,maxYearReg:5},error:""}},mounted:function(){var t=this,a=this.$route.params.topDomain,e=this.$route.params.subDomain;if(this.topData.domain=a,a){this.domain=e;var s=this.$store.getters["web3/getOANNConfigs"];this.configs=c()({},this.configs,s),this.unitPrice=s.subGas,Object(u.a)(a).then(function(a){a.state&&(t.topData=c()({},t.topData,a.data),a.data.isCustomed&&a.data.customPrice&&(t.unitPrice=a.data.customPrice/Math.pow(10,18)))}).catch(function(t){})}},computed:{getTotal:function(){return this.years*this.unitPrice},topExpireDate:function(){return this.topData.expire?Object(d.h)(this.topData.expire):""},showErrorTip:function(){return!!this.error}},methods:{gotoWhois:function(t){t&&(this.$store.getters.metaMaskDisabled?this.$metamask():this.$router.push({path:"/domain/detail/"+t}))},registing:function(){var t=this;return n()(r.a.mark(function a(){var e,s,i,n,o,c,u;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e="域名非法或为空",!t.$store.getters.metaMaskDisabled){a.next=4;break}return t.$metamask(),a.abrupt("return");case 4:if(t.topData.openApplied||Object(d.n)(t.topData.expire)){a.next=8;break}return e="顶级域名 "+t.topData.domain+" 未开放注册.",t.$message(t.$basTip.error(e)),a.abrupt("return");case 8:if(t.domain&&!Object(l.a)(t.domain)&&t.topData.domain){a.next=12;break}return s="域名非法或为空",t.$message(t.$basTip.error(s)),a.abrupt("return");case 12:return i=t.domain+"."+t.topData.domain,Object(l.a)(i)&&t.$message(t.$basTip.error("只支持二级域名注册.")),a.next=16,Object(p.f)(i);case 16:if(!(n=a.sent).exist||!n.owner){a.next=20;break}return t.$message(t.$basTip.error(t.domain+"."+t.topData.domain+" 域名已存在,请选用其他域名注册!")),a.abrupt("return");case 20:t.$store.getters["web3/dappState"],o=t.years,c=t.domain.toLowerCase().trim(),u=t.topData.domain.toLowerCase().trim(),Object(m.a)(o,c,u).then(function(a){if(a.isValid)if(Object(d.i)(a.currentBalance,a.cost)){var e={costWei:a.cost,isSubdomain:!0,domain:c,year:o,topDomain:u};t.$router.push({name:"domain.newregisting",params:{commitData:e}})}else{var s=t.$t("g.LackOfBasBalance");t.$message(t.$basTip.error(s))}else t.$message(t.$basTip.error("预估价格未通过"))}).catch(function(a){9001!=a||t.$alert(" "+t.domain+"."+t.topData.domain+" 域名已存在,请选用其他域名注册!")});case 25:case"end":return a.stop()}},a,t)}))()}},watch:{domain:function(t){Object(l.a)(t)?this.error="域名非法":this.error=""}}},f={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-7 bas-card"},[t._m(0),t._v(" "),e("div",{staticClass:"bas-gray-split"}),t._v(" "),e("div",{staticClass:"bas-card__body bas-border-none"},[e("el-form",{staticClass:"col-10",attrs:{"label-width":"160px"}},[e("el-form-item",{attrs:{label:"域名"}},[e("el-input",{staticClass:"bas-regist--domain-input",attrs:{placeholder:"please enter domain..."},model:{value:t.domain,callback:function(a){t.domain=a},expression:"domain"}},[e("template",{slot:"append"},[t._v(t._s("."+t.topData.domain))])],2),t._v(" "),t.showErrorTip?e("div",{staticClass:"bas-text-warning"},[e("i",{staticClass:"fa fa-warning"}),t._v("\n              "+t._s(t.error)+"\n            ")]):t._e()],1),t._v(" "),t._e(),t._v(" "),e("el-form-item",{attrs:{label:"价格"}},[e("span",[t._v(" "+t._s(t.unitPrice)+" ")]),t._v(" "),e("span",[t._v(" UDID/year ")])]),t._v(" "),e("el-form-item",{attrs:{label:"购买期限"}},[e("el-input-number",{attrs:{name:"years","controls-position":"right",min:1,max:t.configs.maxYearReg},model:{value:t.years,callback:function(a){t.years=a},expression:"years"}}),t._v(" "),e("span",[t._v("Year")])],1)],1),t._v(" "),e("div",{staticClass:"row justify-content-center align-items-center"},[e("el-form",{staticClass:"col-10 bas-topinfo-container",attrs:{size:"mini","label-position":"right"}},[e("el-form-item",[e("h6",{staticClass:"pt-2",attrs:{slot:"label"},slot:"label"},[t._v("其根域名信息")])]),t._v(" "),e("el-form-item",{attrs:{"label-width":"120px",label:"到期日期"}},[e("span",[t._v(t._s(t.topExpireDate))])]),t._v(" "),e("el-form-item",{attrs:{"label-width":"120px",label:"所有者"}},[t._v("\n              "+t._s(t.topData.owner?t.topData.owner:"未注册")+"\n            ")]),t._v(" "),""!==t.topData.owner?e("el-form-item",{attrs:{"label-width":"120px"}},[e("a",{staticClass:"bas-link topinfo-whois",attrs:{slot:"label"},on:{click:function(a){return a.preventDefault(),t.gotoWhois(t.topData.domain)}},slot:"label"},[t._v("\n                Who is >>\n              ")])]):t._e()],1)],1),t._v(" "),e("div",{staticClass:"col-12 text-center pt-3"},[e("span",{staticClass:"bas-text-green"},[t._v("总计:")]),t._v(" "),e("h2",{staticClass:"d-inline bas-text-green"},[t._v(t._s(t.getTotal))]),t._v(" "),e("span",{staticClass:"bas-text-green"},[t._v("BAS")]),t._v(" "),e("div",{staticClass:"bas-card__footer"},[e("button",{staticClass:"btn w-25 bas-btn-primary",on:{click:t.registing}},[t._v("\n              注册\n            ")])])])],1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"bas-card__header"},[a("div",{staticClass:"bas-card__header-title"},[this._v("注册子域名")])])}]};var h=e("VU/8")(b,f,!1,function(t){e("M/Ax"),e("hTOq")},null,null);a.default=h.exports},hTOq:function(t,a){}});
//# sourceMappingURL=19.88e2ab77a88223a6b69a.js.map